From 1c96ca8bafd4b21e7ae896f14d77bbe73de685e9 Mon Sep 17 00:00:00 2001
From: LiFeng <lifeng68@huawei.com>
Date: Thu, 24 Oct 2019 00:12:47 -0400
Subject: [PATCH 31/37] isulad-kit: fix default max to 20480

Signed-off-by: LiFeng <lifeng68@huawei.com>
---
 vendor/pkg/gopkgs/cbb_adapt/src/go/aeswithkey/aeswithkey.go | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/vendor/pkg/gopkgs/cbb_adapt/src/go/aeswithkey/aeswithkey.go b/vendor/pkg/gopkgs/cbb_adapt/src/go/aeswithkey/aeswithkey.go
index 1db2511..1c5cc62 100644
--- a/vendor/pkg/gopkgs/cbb_adapt/src/go/aeswithkey/aeswithkey.go
+++ b/vendor/pkg/gopkgs/cbb_adapt/src/go/aeswithkey/aeswithkey.go
@@ -95,7 +95,8 @@ const (
 	PBKDF2_HMAC_SHA256 = 2
 	ROOTMATERIAL       = "root.key"
 	SHAREDMATERIAL     = "common_shared.key"
-	PBKDF2_ITERATION   = 2048
+	PBKDF2_ITERATION   = 10000
+	MAX_ITERATION      = 20480
 	ENCRYPTED          = 1
 	UNENCRYPTED        = 0
 	MATERIAL_VERSION_1 = 1
@@ -370,7 +371,7 @@ func newMaterial(info []byte) (*MaterialItem, error) {
 	}
 
 	//check iteration, it is not constant, but could not too mush, to prevent DoS attacks
-	if material.Iteration > PBKDF2_ITERATION*10 {
+	if material.Iteration > MAX_ITERATION {
 		return nil, fmt.Errorf("material iteration %d is too lager.", material.Iteration)
 	}
 
-- 
2.19.1

